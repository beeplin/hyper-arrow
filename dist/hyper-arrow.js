let c=0,p=1,n=1,m=2,v=3,d=4,s=5,r=1,f="__hyper_arrow__",o=Symbol(f),i=null,h=new Map;var e=new Proxy({},{get:(e,r)=>new Proxy({},{get:(e,t)=>l.bind(null,r+":"+t)})});let l=function(e,t,r){var[e,n]=e.split(":"),[e,n]=n?[e,n]:[n,"html"];if("html"!==e&&"svg"!==e&&"mathml"!==e)throw new Error("tag type must be 'html', 'svg' or 'mathml'");var o=[e,n,{__proto__:null},[]];if("object"!=typeof t||Array.isArray(t))r=t;else for(var i in t)i.startsWith("on")?o[m][i.toLowerCase()]=t[i]:o[m][i]=P(t[i],o,i);var l,f=P(r,o,null)??[];for(l in f)o[v].push(w(P(f[l],o,+l)));return o};function w(e){return"string"==typeof e?["text",e,{},[]]:e}function t(e,t){document.querySelector(e).append(_(t))}let u="uid",a="oncreate",g="cacheRemovedChildren",y={html:"http://www.w3.org/1999/xhtml",svg:"http://www.w3.org/2000/svg",mathml:"http://www.w3.org/1998/Math/MathML"},b=0;function _(e){var t,[r,n,o,i]=e,l=document.createElementNS(y[r],n);for(t in l.setAttribute(u,b+++""),o)R(l,t,o[t]);return l.append(...i.map(x)),(l[f]=e)[d]=l,o[g]&&E(i)&&(e[s]={}),o[a]?.(l),l}function x(e){return"text"===e[c]?(t=e,((r=document.createTextNode(t[n]))[f]=t)[d]=r):_(e);var t,r}function A(t,e){return P(t,null,null,e),()=>{for(var e of h.keys())e[0]===t&&h.delete(e)}}function P(e,t,r,n){if("function"!=typeof e)return e;i=t?[e,t,r]:[e,null,null,n];t=e();return i=null,t}let N=e=>!!e[o];function O(e){return e!==Object(e)||N(e)?e:new Proxy(e,{get(t,r){var e,n;return r===o||(e=Reflect.get(t,r),"function"==typeof t&&"prototype"===r?e:(i&&(h.has(i)||h.set(i,[]),(n=h.get(i)).some(e=>e[0]===t&&e[1]===r)||n.push([t,r])),O(e)))},set(e,t,r){var n,o,i,l=Reflect.get(e,t),f=Reflect.set(e,t,r);if(l!==r||"length"===t)for(var[u,s]of h.entries())for(var a of s)a[0]===l&&(a[0]=r),a[0]===e&&a[1]===t&&([a,n,o,i]=u,a=a(),n?null===o?(n[v].map($),j(n,a.map(w))):"number"==typeof o?($(n[v][o]),M(n,o,w(a))):R(n[d],o,a):i?.(a));return f}})}function $(e){for(var t of h.keys())!function t(e,r){if(!r)return!1;if(e===r)return!0;let n=e[v].some(e=>t(e,r));return n}(e,t[r])||h.delete(t)}function j(r,n){var t=E(r[v]),o=E(n);if(t&&o){for(let e=t.length-1;0<=e;e--)o.includes(t[e])||L(r,e);for(let[e,t]of o.entries()){var i=r[v].findIndex(e=>e[m].id===t),l=n[e];(e===i?M:r[v][i]?(C(r,e,L(r,i)),M):r[s]?.[t]?(C(r,e,r[s][t]),M):C)(r,e,l)}}else{var f=n.length,u=r[v].length;for(let e=0;e<f||e<u;e++)e<f&&e<u?M(r,e,n[e]):e>=u?C(r,e,n[e]):L(r,u+f-1-e)}}function E(e){var t=e.map(e=>e[m].id).filter(e=>"string"==typeof e);if(new Set(t).size!==t.length)throw new Error("duplicate children id: "+t);return t.length===e.length?t:null}function M(e,t,r){var n=e[v][t];if("text"!==n[c]&&"text"!==r[c]&&n[p]===r[p]){var o,i,l=n[d];for(o in r[m])n[m][o]!==r[m][o]&&R(l,o,r[m][o]);for(i in n[m])if(!(i in r[m])){a=s=u=f=void 0;var f=l,u=i;if(u.toLowerCase()in f.attributes)f.removeAttribute(u);else if(u in S)f.removeAttribute(S[u]);else if(u in f)f[u]="string"==typeof f[u]?"":void 0;else{var s=u[0],a=u.slice(1);if("_"===s)f.removeAttribute(a);else{if("$"!==s)throw new Error(`invalid prop '${u}' to unset from <${f.nodeName}>`);f.style.removeProperty(a)}}}["innerText","innerHTML","textContent"].some(e=>e in r[m])||j(n,r[v]),r[d]=n[d],e[v][t]=r}else L(e,t),C(e,t,r)}function C(e,t,r){var n=e[d],o=r[d]??x(r);n.insertBefore(o,n.childNodes.item(t)),e[v].splice(t,0,r),e[s]&&r[m].id&&delete e[s][r[m].id]}function L(e,t){t=e[v].splice(t,1)[0];return t[d].remove(),e[s]&&t[m].id&&(e[s][t[m].id]=t),t}function R(e,t,r){if(![a,g].includes(t))if(function e(t,r){if(!(r in t))return[];let n=Object.getOwnPropertyDescriptor(t,r);if(n)return Object.entries(n).map(([e,t])=>t?e:null).filter(e=>e);let o=Object.getPrototypeOf(t);if(!o)return[];return e(o,r)}(e,t).includes("set"))e[t]=r;else{if("string"!=typeof r)throw new Error(`<${e.nodeName}> attr/style must be string: ${t} = `+r);"$"===t[0]?e.style.setProperty(t.slice(1),r):"_"===t[0]?e.setAttribute(t.slice(1),r):e.setAttribute(t,r)}}let S={defaultValue:"value",htmlFor:"for",className:"class",__proto__:null};export{h as deps,e as tags,l as h,t as mount,A as watch,N as isReactive,O as reactive};