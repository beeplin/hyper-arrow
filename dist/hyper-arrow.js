let u="cacheChildren",a="__hyper_arrow__",o=Symbol(a),c={html:"http://www.w3.org/1999/xhtml",svg:"http://www.w3.org/2000/svg",mathml:"http://www.w3.org/1998/Math/MathML"},i=null,v=new Map;var e=new Proxy({},{get:(e,r)=>new Proxy({},{get:(e,t)=>n.bind(null,r+":"+t)})});let n=function(e,t,r){var[e,n]=e.split(":"),[e,n]=n?[e,n]:[n,"html"],o=[e,n,Object.create(null),[]];if("object"!=typeof t||Array.isArray(t))r=t;else for(var i in t)i.startsWith("on")?o[2][i.toLowerCase()]=t[i]:o[2][i]=s(t[i],o,i);var l,f=s(r,o,null)??[];for(l in f)o[3].push(p(s(f[l],o,+l)));return o};function p(e){return"string"==typeof e?["text",e,Object.create(null),[]]:e}function t(t,e){return s(t,null,null,e),()=>{for(var e of v.keys())e[0]===t&&v.delete(e)}}function s(e,t,r,n){if("function"!=typeof e)return e;i=t?[e,t,r]:[e,null,null,n];t=e();return i=null,t}function r(e,t){document.querySelector(e).append(d(t))}function d(e){if(e[4])return e[4];let[t,r,n,o]=e;var i,l=document.createElementNS(c[t],r);for(i in(e[4]=l).setAttribute("uid",Math.random().toString().slice(2,4)),l.append(...o.map(h)),n)M(e,i,n[i]);var f=m(o);return n[u]&&f&&(e[5]=f.reduce((e,t,r)=>({...e,[t]:o[r]}),{})),n.oncreate?.(l),l[a]=e,l}function h(e){return("text"===e[0]?e=>{var t;return e[4]||(t=document.createTextNode(e[1]),(e[4]=t)[a]=e,t)}:d)(e)}function m(e){var t=e.map(e=>e[2].id).filter(e=>"string"==typeof e);if(new Set(t).size!==t.length)throw new Error("duplicate child id");return t.length===e.length?t:null}let l=e=>!!e[o];function f(e){return e!==Object(e)||l(e)?e:new Proxy(e,{get(e,t){var r,n;return t===o||(r=Reflect.get(e,t),"function"==typeof e&&"prototype"===t?r:(i&&(v.has(i)||v.set(i,[]),(n=v.get(i)).some(e=>e[0]===e&&e[1]===t)||n.push([e,t])),f(r)))},set(e,t,r){var n=Reflect.get(e,t),o=Reflect.set(e,t,r);if(n!==r||"length"===t)for(var[i,l]of v.entries())for(var f of l)if(f[0]===n&&(f[0]=r),f[0]===e&&f[1]===t){var[f,u,a,c]=i,f=(console.log({t:e,p:t,newValue:r,el:u?.[4],k:a}),f());if(u)if(null===a){for(var s of u[3])w(s);g(u,f.map(p))}else"number"==typeof a?(w(u[3][a]),y(u,a,p(f))):_(u,a,f);else c?.(f)}return o}})}function w(e){for(var t of v.keys())!function t(e,r){if(!r)return!1;if(e===r)return!0;let n=e[3].some(e=>t(e,r));return n}(e,t[1])||v.delete(t)}function g(r,n){var t=m(r[3]),o=m(n);if(t&&o){for(let e=t.length-1;0<=e;e--)o.includes(t[e])||b(r,e);for(let[e,t]of o.entries()){var i=r[3].findIndex(e=>e[2].id===t),l=n[e];(e===i?y:r[3][i]?(x(r,e,b(r,i)),y):r[5]?.[t]?(x(r,e,r[5][t]),y):x)(r,e,l)}}else{var f=n.length,u=r[3].length;for(let e=0;e<f||e<u;e++)e<f&&e<u?y(r,e,n[e]):e>=u?x(r,e,n[e]):b(r,e)}}function y(e,t,r){var n=e[3][t];if("text"!==n[0]&&"text"!==r[0]&&n[1]===r[1]){let t=r[2];for(var o in t)_(n,o,t[o]);for(var i in n[2])if(!(i in t)){f=l=void 0;var l=n,f=i;delete l[2][f],l=d(l),"$"===f[0]?l.style.removeProperty(f.slice(1)):"_"===f[0]||f.toLowerCase()in l.attributes?l.removeAttribute(f.replace(/^_/,"")):l[f]=void 0}["innerText","innerHTML","textContent"].some(e=>e in t)||g(n,r[3])}else b(e,t),x(e,t,r)}function x(e,t,r){e[3].splice(t,0,r);var n=d(e);n.insertBefore(h(r),n.childNodes.item(t)),e[5]&&r[2].id&&(e[5][r[2].id]=r)}function b(e,t){e=e[3].splice(t,1)[0],t=h(e);return e[2].onremove?.(t),t.remove(),e}function _(e,t,r){e[2][t]!==r&&M(e,t,r)}function M(e,t,r){e[2][t]=r;e=d(e);"$"===(t="class"!==t&&"for"!==t?t:"_"+t)[0]?e.style.setProperty(t.slice(1),r):"_"===t[0]?e.setAttribute(t.slice(1),r):e[t]=r}export{v as deps,e as tags,n as h,t as watch,r as mount,l as isReactive,f as reactive};