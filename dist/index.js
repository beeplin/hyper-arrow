let i=Symbol("brand"),f=null,h=new Map;function l(e,t,r,n){if("function"!=typeof e)return e;f=t?[e,t,r]:[e,,,n];t=e();return f=null,t}function r(e,t,r){var n,o=[e,Object.create(null),[]];if("object"!=typeof t||Array.isArray(t))r=t;else for(var i in t)o[1][i]=i.startsWith("on")?t[i]:l(t[i],o,i);for(n in l(r??[],o,"*"))o[2].push(l(r[n],o,"#"+n));return o}var e=new Proxy({},{get:(e,t)=>r.bind(null,t)});function t(t,e){return l(t,null,null,e),()=>{for(var e of h.keys())e[0]===t&&h.delete(e)}}function s(e){return e!==Object(e)||n(e)?e:new Proxy(e,{get(e,t){var r,n,o;return t===i||(r=Reflect.get(e,t),"function"==typeof e&&"prototype"===t?r:([n,o]=[[e,t]][0],f&&(h.has(f)||h.set(f,[]),(e=h.get(f)).some(e=>e[0]===n&&e[1]===o)||e.push([n,o])),s(r)))},set(e,t,r){var n=Reflect.get(e,t),o=Reflect.set(e,t,r),i=e,f=t,l=n,s=r;if(l!==s||"length"===f)for(var[a,u]of h.entries())for(var c of u)if(c[0]===l&&(c[0]=s),c[0]===i&&c[1]===f){var p,[c,d,v,y]=a,c=c();if(d)if("*"===v){for(var g of d[2])m(g);b(d,c)}else"#"===v[0]?(p=+v.slice(1),m(d[2][p]),C(d,p,c)):((e,t,r)=>{var[,e,,n]=e;e[t]!==r&&w(n,t,e[t]=r)})(d,v,c);else y&&y(c)}return o}})}let n=e=>!!e[i];function o(e,t){document.querySelector(e).append(a(t))}function a(e){if("string"==typeof e)return document.createTextNode(e);var t,[r,n,o]=e,i=document.createElement(r);for(t in(e[3]=i).dataset.id=Math.random().toString().slice(2,5),i.append(...o.map(a)),n)w(i,t,n[t]);return i}function m(e){if("string"!=typeof e)for(var t of h.keys())!function t(e,r){if(e===r)return!0;return e[2].filter(e=>"string"!=typeof e).some(e=>t(e,r))}(e,t[1])||h.delete(t)}function b(e,t){var r,[,,n,o]=e;for(r in t)+r<n.length?C(e,+r,t[r]):o.append(a(t[r]));for(let e=t.length;e<n.length;e++)o.removeChild(o.lastChild);e[2]=t}function C(e,t,r){var n,o,i=e[2][t];if("string"!=typeof i&&"string"!=typeof r&&i[0]===r[0]){var f,[,l,,s]=i;let[,t,e]=r;for(f in r[3]=s,t)t[f]!==l[f]&&w(s,f,t[f]);for(let e in l)e in t||(n=s,"$"===(o=e)[0]?n.style[o.slice(1)]=null:"_"===o[0]||o.toLowerCase()in n.attributes?n.removeAttribute(o.replace(/^_/,"").toLowerCase()):n[o]=void 0);["innerText","textContent"].some(e=>e in t)||b(i,e)}else e[3].replaceChild(a(r),e[3].childNodes[t]);e[2][t]=r}function w(e,t,r){"$"===(t="class"!==t&&"for"!==t?t:"_"+t)[0]?e.style[t.slice(1)]=r:"_"===t[0]?e.setAttribute(t.slice(1),r):t.startsWith("on")?e[t.toLowerCase()]=r:e[t]=r}export{h as deps,r as h,e as tags,t as watch,s as reactive,n as isReactive,o as mount};